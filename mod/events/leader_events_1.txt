############################
#
# Leader Events
#
# Written by Henrik Thyrwall
#
############################

namespace = leader
# New Admiral
country_event = {
	id = leader.1
	title = "leader.1.name"

	desc = {
		trigger = { is_hive_empire = yes }
		text = "leader.1.desc.hive"
	}
	desc = {
		trigger = { is_machine_empire = yes }
		text = "leader.1.desc.machine"
	}
	desc = {
		trigger = {
			is_hive_empire = no
			is_machine_empire = no
		}
		text = "leader.1.desc"
	}

	picture = {
		trigger = {
			fromfrom = {
				is_ship_class = shipclass_military
				root = { country_uses_bio_ships = no }
			}
		}
		picture = GFX_evt_federation_fleet
	}
	picture = {
		trigger = {
			fromfrom = {
				is_ship_class = shipclass_military_station
				root = { country_uses_bio_ships = no }
			}
		}
		picture = GFX_evt_space_station
	}
	picture = {
		trigger = {
			fromfrom = {
				is_ship_class = shipclass_military
				root = { country_uses_bio_ships = yes }
			}
		}
		picture = GFX_evt_bio_ships_orbiting
	}
	picture = {
		trigger = {
			fromfrom = {
				is_ship_class = shipclass_military_station
				root = { country_uses_bio_ships = yes }
			}
		}
		picture = GFX_evt_bioship_hangar
	}

	location = root
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		any_owned_leader = { leader_class = commander }
		NOT = { has_country_flag = recent_promising_officer }
		fromfrom = { # Civilian Ships should not generate officers
			OR = {
				is_ship_class = shipclass_military_station
				is_ship_class = shipclass_military
			}
		}
	}

	immediate = {
		set_timed_country_flag = { flag = recent_promising_officer years = 2 }
		fromfrom = {
			solar_system = { save_event_target_as = system }
			random_controlled_ship = { save_event_target_as = ship }
		}
		random_list = {
			25 = {
				create_leader = {
					class = commander
					species = owner_species
					name = random
					skill = 2
					traits = {
						1 = leader_trait_gale_speed # councilor_trait_not_allowed
						2 = leader_trait_aggressive
						0 = leader_trait_eager
					}
				}
			}
			25 = {
				create_leader = {
					class = commander
					species = owner_species
					name = random
					skill = 2
					traits = {
						1 = leader_trait_aggressive
						2 = leader_trait_engineer
						0 = leader_trait_eager
					}
				}
			}
			25 = {
				create_leader = {
					class = commander
					species = owner_species
					name = random
					skill = 2
					traits = {
						1 = leader_trait_fleet_logistician
						2 = leader_trait_cautious
						0 = leader_trait_eager
					}
				}
			}
			25 = {
				create_leader = {
					class = commander
					species = owner_species
					name = random
					skill = 2
					traits = {
						1 = leader_trait_scout
						2 = leader_trait_trickster
						0 = leader_trait_eager
					}
				}
			}
		}
		last_created_leader = { # Vfix
			save_event_target_as = officer
			update_leader_after_modification = yes
		}
		if = { # Vfix by Dr. Addiction
			limit = { is_crusader_empire = yes }
			if = {
				limit = { has_valid_civic = civic_crusader_spirit }
				event_target:officer = {
					add_trait = {
						trait = leader_trait_crusader
						consume_selection = no
						show_message = no
					}
				}
			}
			else_if = {
				limit = { has_valid_civic = civic_crusader_spirit_corporate }
				event_target:officer = {
					add_trait = {
						trait = leader_trait_corsair
						consume_selection = no
						show_message = no
					}
				}
			}
		}
	}

	option = {
		name = GOOD
		custom_tooltip = new_admiral
	}
}

### COMMANDER TRAITS
# Trickster gained from Victory
country_event = {
	id = leader.5
	title = "admiral_trait_gain"

	desc = {
		trigger = { is_hive_empire = yes }
		text = "leader.newadmiraltrait.desc.hive"
	}
	desc = {
		trigger = { is_machine_empire = yes }
		text = "leader.newadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			is_hive_empire = no
			is_machine_empire = no
		}
		text = "leader.5.desc"
	}

	picture = GFX_evt_federation_fleet
	location = root
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		fromfrom = {
			exists = leader
			leader = {
				leader_class = commander
				NOR = {
					num_traits >= 3
					has_trait = leader_trait_trickster
					has_trait = leader_trait_unyielding
				}
			}
		}
	}

	immediate = {
		fromfrom = {
			leader = { save_event_target_as = officer }
			solar_system = { save_event_target_as = system }
		}
	}

	option = {
		name = GOOD
		fromfrom = {
			leader = {
				add_trait = { trait = leader_trait_trickster }
			}
		}
	}
}

# Aggressive gained from Victory
country_event = {
	id = leader.6
	title = "admiral_trait_gain"

	desc = {
		trigger = { is_hive_empire = yes }
		text = "leader.newadmiraltrait.desc.hive"
	}
	desc = {
		trigger = { is_machine_empire = yes }
		text = "leader.newadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			is_hive_empire = no
			is_machine_empire = no
		}
		text = "leader.6.desc"
	}

	picture = GFX_evt_federation_fleet
	location = fromfrom
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		fromfrom = {
			exists = leader
			leader = {
				leader_class = commander
				NOR = {
					num_traits >= 3
					has_trait = leader_trait_cautious
					has_trait = leader_trait_aggressive
				}
			}
		}
	}

	immediate = {
		fromfrom = {
			leader = { save_event_target_as = officer }
			solar_system = { save_event_target_as = system }
		}
	}

	option = {
		name = GOOD
		fromfrom = {
			leader = {
				add_trait = { trait = leader_trait_aggressive }
			}
		}
	}
}

# Unyielding gained from Victory
country_event = {
	id = leader.7
	title = "admiral_trait_gain"

	desc = {
		trigger = { is_hive_empire = yes }
		text = "leader.newadmiraltrait.desc.hive"
	}
	desc = {
		trigger = { is_machine_empire = yes }
		text = "leader.newadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			is_hive_empire = no
			is_machine_empire = no
		}
		text = "leader.7.desc"
	}

	picture = GFX_evt_federation_fleet
	location = fromfrom
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		fromfrom = {
			exists = leader
			leader = {
				leader_class = commander
				NOR = {
					num_traits >= 3
					has_trait = leader_trait_trickster
					has_trait = leader_trait_unyielding
				}
			}
		}
	}

	immediate = {
		fromfrom = {
			leader = { save_event_target_as = officer }
			solar_system = { save_event_target_as = system }
		}
	}

	option = {
		name = GOOD
		fromfrom = {
			leader = {
				add_trait = { trait = leader_trait_unyielding }
			}
		}
	}
}

# Gale Speed gained from Victory
country_event = {
	id = leader.8
	title = "admiral_trait_gain"

	desc = {
		trigger = { is_hive_empire = yes }
		text = "leader.newadmiraltrait.desc.hive"
	}
	desc = {
		trigger = { is_machine_empire = yes }
		text = "leader.newadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			is_hive_empire = no
			is_machine_empire = no
		}
		text = "leader.8.desc"
	}

	picture = GFX_evt_federation_fleet
	location = fromfrom
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		fromfrom = {
			exists = leader
			leader = {
				leader_class = commander
				NOR = {
					num_traits >= 3
					has_trait = leader_trait_lethargic
					has_trait = leader_trait_gale_speed
					has_trait = leader_trait_gale_speed_2
				}
			}
		}
	}

	immediate = {
		fromfrom = {
			leader = { save_event_target_as = officer }
			solar_system = { save_event_target_as = system }
		}
	}

	option = {
		name = GOOD
		fromfrom = {
			leader = {
				add_trait = { trait = leader_trait_gale_speed }
			}
		}
	}
}

# Lethargic lost from Victory
country_event = {
	id = leader.9
	title = "admiral_trait_loss"

	desc = {
		trigger = { is_hive_empire = yes }
		text = "leader.lostadmiraltrait.desc.hive"
	}
	desc = {
		trigger = { is_machine_empire = yes }
		text = "leader.lostadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			is_hive_empire = no
			is_machine_empire = no
		}
		text = "leader.9.desc"
	}

	picture = GFX_evt_federation_fleet
	location = fromfrom
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		fromfrom = {
			exists = leader
			leader = { has_trait = leader_trait_lethargic }
		}
	}

	immediate = {
		fromfrom = {
			leader = { save_event_target_as = officer }
			solar_system = { save_event_target_as = system }
		}
	}

	option = {
		name = GOOD
		fromfrom = {
			leader = { remove_trait = leader_trait_lethargic }
		}
	}
}

# Cautious gained from Defeat
fleet_event = {
	id = leader.10
	title = "admiral_trait_gain"

	desc = {
		trigger = {
			owner = { is_hive_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.hive"
	}
	desc = {
		trigger = {
			owner = { is_machine_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			owner = { is_hive_empire = no is_machine_empire = no }
		}
		text = "leader.10.desc"
	}

	picture = GFX_evt_federation_fleet
	location = root
	is_triggered_only = yes

	trigger = {
		can_generate_trade_value = yes
		exists = leader
		leader = {
			leader_class = commander
			NOR = {
				num_traits >= 3
				has_trait = leader_trait_cautious
				has_trait = leader_trait_aggressive
			}
		}
	}

	immediate = {
		leader = { save_event_target_as = officer }
		from = { save_event_target_as = system } # Vfix
	}

	option = {
		name = GOOD
		event_target:officer = { # Vfix
			add_trait = { trait = leader_trait_cautious }
		}
	}
}

# Nervous gained from Defeat
fleet_event = {
	id = leader.11
	title = "admiral_trait_gain"

	desc = {
		trigger = {
			owner = { is_hive_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.hive"
	}
	desc = {
		trigger = {
			owner = { is_machine_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			owner = { is_hive_empire = no is_machine_empire = no }
		}
		text = "leader.11.desc"
	}

	picture = GFX_evt_federation_fleet
	location = root
	is_triggered_only = yes

	trigger = {
		can_generate_trade_value = yes
		exists = leader
		owner = { has_technology = tech_doctrine_fleet_size_2 }
		leader = {
			num_traits < 3
			leader_class = commander
			NOR = {
				has_trait = leader_trait_fleet_organizer
				has_trait = leader_trait_unyielding
				has_trait = leader_trait_nervous
				has_trait = leader_trait_nervous_2
			}
		}
	}

	immediate = {
		leader = { save_event_target_as = officer }
		from = { save_event_target_as = system } # Vfix
	}

	option = {
		name = UNFORTUNATE
		event_target:officer = { # Vfix
			add_trait = { trait = leader_trait_nervous }
		}
	}
}

# Unyielding gained from Defeat
fleet_event = {
	id = leader.12
	title = "admiral_trait_gain"

	desc = {
		trigger = {
			owner = { is_hive_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.hive"
	}
	desc = {
		trigger = {
			owner = { is_machine_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			owner = { is_hive_empire = no is_machine_empire = no }
		}
		text = "leader.12.desc"
	}

	picture = GFX_evt_federation_fleet
	location = root
	is_triggered_only = yes

	trigger = {
		can_generate_trade_value = yes
		exists = leader
		leader = {
			leader_class = commander
			NOR = {
				num_traits >= 3
				has_trait = leader_trait_nervous
				has_trait = leader_trait_nervous_2
				has_trait = leader_trait_slipshod
				has_trait = leader_trait_slipshod_2
				has_trait = leader_trait_trickster
				has_trait = leader_trait_unyielding
			}
		}
	}

	immediate = {
		leader = { save_event_target_as = officer }
		from = { save_event_target_as = system } # Vfix
	}

	option = {
		name = GOOD
		event_target:officer = { # Vfix
			add_trait = { trait = leader_trait_unyielding }
		}
	}
}

# Gale Speed gained from Defeat
# This = escaping fleet
# From = system escaped from
# FromFrom = system escaping to
fleet_event = {
	id = leader.13
	title = "admiral_trait_gain"

	desc = {
		trigger = {
			owner = { is_hive_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.hive"
	}
	desc = {
		trigger = {
			owner = { is_machine_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			owner = { is_hive_empire = no is_machine_empire = no }
		}
		text = "leader.13.desc"
	}

	picture = GFX_evt_federation_fleet
	location = root
	is_triggered_only = yes

	trigger = {
		can_generate_trade_value = yes
		exists = leader
		leader = {
			leader_class = commander
			NOR = {
				num_traits >= 3
				has_trait = leader_trait_lethargic
				has_trait = leader_trait_gale_speed
				has_trait = leader_trait_gale_speed_2
			}
		}
	}

	immediate = {
		leader = { save_event_target_as = officer }
		from = { save_event_target_as = system } # Vfix
	}

	option = {
		name = GOOD
		event_target:officer = { # Vfix
			add_trait = { trait = leader_trait_gale_speed }
		}
	}
}

# Lethargic gained from Defeat
fleet_event = {
	id = leader.14
	title = "admiral_trait_gain"

	desc = {
		trigger = {
			owner = { is_hive_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.hive"
	}
	desc = {
		trigger = {
			owner = { is_machine_empire = yes }
		}
		text = "leader.newadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			owner = { is_hive_empire = no is_machine_empire = no }
		}
		text = "leader.14.desc"
	}

	picture = GFX_evt_federation_fleet
	location = root
	is_triggered_only = yes

	trigger = {
		can_generate_trade_value = yes
		exists = leader
		leader = {
			leader_class = commander
			NOR = {
				num_traits >= 3
				has_trait = leader_trait_gale_speed
				has_trait = leader_trait_gale_speed_2
				has_trait = leader_trait_lethargic
			}
		}
	}

	immediate = {
		leader = { save_event_target_as = officer }
		from = { save_event_target_as = system } # Vfix
	}

	option = {
		name = UNFORTUNATE
		event_target:officer = { # Vfix
			add_trait = { trait = leader_trait_lethargic }
		}
	}
}

# Engineer gained from Repairing
fleet_event = {
	id = leader.15
	title = "admiral_trait_gain"

	desc = {
		trigger = {
			owner = { is_hive_empire = yes }
		}
		text = "leader.optimizations.desc.hive"
	}
	desc = {
		trigger = {
			owner = { is_machine_empire = yes }
		}
		text = "leader.optimizations.desc.machine"
	}
	desc = {
		trigger = {
			owner = { is_hive_empire = no is_machine_empire = no }
		}
		text = "leader.15.desc"
	}

	picture = GFX_evt_federation_fleet
	location = root

	trigger = {
		can_generate_trade_value = yes # Vfix flex
		is_being_repaired = yes
		exists = leader
		owner = { is_gestalt = no has_technology = tech_doctrine_fleet_size_3 }
		leader = {
			leader_class = commander
			NOR = {
				num_traits >= 3
				has_trait = leader_trait_engineer
			}
		}
	}

	# Vfix TODO DEPRECATE
	mean_time_to_happen = {
		years = 20
	}

	immediate = {
		leader = { save_event_target_as = officer }
	}

	option = {
		name = GOOD
		event_target:officer = { # Vfix
			add_trait = { trait = leader_trait_engineer }
		}
	}
}

# Organizer gained from Large Fleet
# fleet_event = {
#	id = leader.16
#	title = "admiral_trait_gain"
#	desc = "leader.16.desc"
#	picture = GFX_evt_federation_fleet
#	location = ROOT
#
#	trigger = {
#		owner = { is_country_type = default }
#		exists = leader
#		num_ships > 1
#		leader = {
#			num_traits < 3
#			NOT = {
#				has_trait = leader_trait_fleet_organizer
#				has_trait = leader_trait_nervous
#			}
#		}
#		owner = { has_technology = tech_doctrine_fleet_size_3 }
#	}
#
#	mean_time_to_happen = {
#		months = 240
#	}
#
#	immediate = {
#		leader = { save_event_target_as = officer }
#	}
#
#	option = {
#		name = GOOD
#		leader = {
#			add_trait = {
#				trait = leader_trait_fleet_organizer
#			}
#		}
#	}
# }
# Nervous lost from Victory
country_event = {
	id = leader.17
	title = "admiral_trait_loss"

	desc = {
		trigger = { is_hive_empire = yes }
		text = "leader.lostadmiraltrait.desc.hive"
	}
	desc = {
		trigger = { is_machine_empire = yes }
		text = "leader.lostadmiraltrait.desc.machine"
	}
	desc = {
		trigger = {
			is_hive_empire = no
			is_machine_empire = no
		}
		text = "leader.17.desc"
	}

	picture = GFX_evt_federation_fleet
	location = fromfrom
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		fromfrom = {
			exists = leader
			leader = { has_trait = leader_trait_nervous }
		}
	}

	immediate = {
		fromfrom = {
			leader = { save_event_target_as = officer }
			solar_system = { save_event_target_as = system }
		}
	}

	option = {
		name = GOOD
		fromfrom = {
			leader = { remove_trait = leader_trait_nervous }
		}
	}
}

# Logistics gained from Large Fleet
# fleet_event = {
#	id = leader.18
#	title = "admiral_trait_gain"
#	desc = {
#		trigger = { owner = { is_hive_empire = yes } }
#		text = "leader.optimizations.desc.hive"
#	}
#	desc = {
#		trigger = { owner = { is_machine_empire = yes } }
#		text = "leader.optimizations.desc.machine"
#	}
#	desc = {
#		trigger = {
#			owner = {
#				NOR = {
#					is_hive_empire = yes
#					is_machine_empire = yes
#				}
#			}
#		}
#		text = "leader.18.desc"
#	}
#	picture = GFX_evt_federation_fleet
#	location = ROOT
#
#	trigger = {
#		owner = {
#			is_country_type = default
#			NOT = { has_ethic = ethic_gestalt_consciousness }
#		}
#		exists = leader
#		num_ships > 1
#		leader = {
#			leader_class = commander
#			num_traits < 3
#			NOT = { has_trait = leader_trait_fleet_logistician }
#		}
#	}
#
#	mean_time_to_happen = {
#		months = 240
#	}
#
#	immediate = {
#		leader = { save_event_target_as = officer }
#	}
#
#	option = {
#		name = GOOD
#		if = {
#			limit = {
#				owner = {
#					NOT = { has_authority = "auth_machine_intelligence" }
#				}
#			}
#			leader = {
#				add_trait = {
#					trait = leader_trait_fleet_logistician
#				}
#			}
#		}
#		if = {
#			limit = {
#				owner = { has_authority = "auth_machine_intelligence" }
#			}
#			leader = {
#				add_trait = {
#					trait = leader_trait_maintenance_loop
#				}
#			}
#		}
#	}
# }
# Scout gained from Exploration
ship_event = {
	id = leader.19
	title = "admiral_trait_gain"

	desc = {
		trigger = {
			owner = { is_hive_empire = yes }
		}
		text = "leader.optimizations.desc.hive"
	}
	desc = {
		trigger = {
			owner = { is_machine_empire = yes }
		}
		text = "leader.optimizations.desc.machine"
	}
	desc = {
		trigger = {
			owner = { is_hive_empire = no is_machine_empire = no }
		}
		text = "leader.19.desc"
	}

	picture = GFX_evt_federation_fleet
	location = root
	is_triggered_only = yes

	trigger = {
		exists = owner
		owner = { is_country_type = default is_gestalt = no }
		fleet = {
			exists = leader
			num_ships > 1
			leader = {
				leader_class = commander
				NOR = {
					num_traits >= 3
					has_trait = leader_trait_scout
					has_trait = leader_trait_scout_2
				}
			}
		}
	}

	immediate = {
		fleet = {
			leader = { save_event_target_as = officer }
			solar_system = { save_event_target_as = system }
		}
	}

	option = {
		name = GOOD
		fleet = {
			leader = {
				add_trait = { trait = leader_trait_scout }
			}
		}
	}
}

# banning AI removes AI-dependent traits from leaders
country_event = {
	id = leader.30
	title = leader.30.name
	desc = leader.30.desc
	picture = GFX_evt_throne_room
	is_triggered_only = yes

	trigger = {
		last_changed_policy = artificial_intelligence_policy
		has_policy_flag = ai_outlawed
		any_owned_leader = { has_trait = leader_trait_sapient_AI_assistant }
	}

	option = {
		name = GOOD
		every_owned_leader = {
			limit = { has_trait = leader_trait_sapient_AI_assistant } # Vfix opt
			remove_trait = leader_trait_sapient_AI_assistant
		}
	}
}
