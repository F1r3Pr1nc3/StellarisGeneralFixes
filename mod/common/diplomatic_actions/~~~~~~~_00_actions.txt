# Leave a federation. Harms relations and sets a 10 year truce with whole federation.
action_leave_federation = {
	icon = "GFX_diplomacy_status_federation"
	auto_accepted = yes
	requires_actor_peace = yes
	show_to_alliance_members = yes
	should_notify_all_communications = yes
	action_type = negative

	# We do not want the AI to leave federations because it does not like its subjects
	should_ai_propose = {
		weight = 1
		modifier = {
			factor = 0
			exists = from
			from = { is_subject = yes }
		}
	}

	potential = {
		hidden_trigger = {
			OR = {
				AND = {
					is_subject = no
					has_federation = yes
					NOT = { federation = { has_federation_type = hegemony_federation } }
				}
				AND = {
					is_subject = no
					has_federation = yes
					federation = {
						has_federation_type = hegemony_federation
					}
					is_federation_leader = yes
				}
			}
		}
	}
	proposable = {
		custom_tooltip = {
			fail_text = requires_federation_leader_exists
			federation = { federation_election_underway = no } # messes up federation election chains
		}
	}
}

action_ask_to_leave_federation = {
	icon = "GFX_diplomacy_status_federation"
	auto_accepted = no
	requires_actor_peace = yes
	show_to_alliance_members = yes
	should_notify_all_communications = yes
	action_type = negative

	# We do not want the AI to leave federations because it does not like its subjects
	should_ai_propose = {
		weight = 1
		modifier = {
			factor = 0
			exists = from
			from = { is_subject = yes }
		}
		modifier = {
			factor = 0
			exists = from
			from = { is_federation_leader = no }
		}
	}

	potential = {
		hidden_trigger = {
			has_federation = yes
			federation = {
				has_federation_type = hegemony_federation
			}
			from = {
				is_federation_leader = yes
			}
		}
	}

	proposable = {
		custom_tooltip = {
			fail_text = requires_federation_leader_exists
			federation = { federation_election_underway = no } # messes up federation election chains
		}
		custom_tooltip = {
			fail_text = "requires_actor_not_already_asked"
			NOT = { has_country_flag = asked_to_leave_hegemony }
		}
		custom_tooltip = {
			fail_text = "requires_actor_not_rebelled"
			NOT = { has_country_flag = failed_hegemony_rebellion }
		}
	}
}
