# Keept for backward compat. Identical to vanilla v4.1.7
# The policy flags are checked when a pop is grown, assembled or switches ethic. Also when the leader pool refreshes.
# cyberization_standards_full    - Everyone gets the Cybernetic/Cyborg trait
# cyberization_standards_limited - Spiritualists get the Limited Cybernetic/Cyborg trait
cyberization_standards = {
	potential = {
		OR = {
			has_country_flag = cyber_force_objectors
			has_country_flag = cyber_allow_objectors
		}
	}

	# Fires when the policy group first becomes available
	on_activate = {
	}

	option = {
		name = cyberization_standards_full
		policy_flags = { cyberization_standards_full }
		on_enabled = {
			hidden_effect = {
				if = {
					limit = {
						any_situation = {
							is_situation_type = situation_cyberization
							has_situation_flag = cyberization_ongoing_limited
						}
					}
					random_situation = {
						limit = {
							is_situation_type = situation_cyberization
							has_situation_flag = cyberization_ongoing_limited
						}
						remove_situation_flag = cyberization_ongoing_limited
						set_situation_flag = cyberization_ongoing_forced
					}
				}
				if = {
					limit = {
						any_situation = {
							is_situation_type = situation_cyberization_hive
							has_situation_flag = cyberization_ongoing_limited
						}
					}
					random_situation = {
						limit = {
							is_situation_type = situation_cyberization_hive
							has_situation_flag = hive_cyberization_ongoing_limited
						}
						remove_situation_flag = hive_cyberization_ongoing_limited
						set_situation_flag = cyberization_ongoing
					}
				}
				every_owned_pop_group = {
					limit = { has_trait = trait_limited_cybernetic }
					species = { save_event_target_as = limited_species }
					convert_from_limited_cybernetic_effect = yes
				}
				every_owned_leader = {
					limit = { has_trait = leader_trait_limited_cyborg }
					remove_trait = leader_trait_limited_cyborg
					add_trait = { trait = leader_trait_cyborg show_message = no }
					species = { save_event_target_as = limited_species }
					convert_from_limited_cybernetic_effect = yes
				}
				every_pool_leader = {
					limit = { has_trait = leader_trait_limited_cyborg }
					remove_trait = leader_trait_limited_cyborg
					add_trait = { trait = leader_trait_cyborg show_message = no }
					species = { save_event_target_as = limited_species }
					convert_from_limited_cybernetic_effect = yes
				}
			}
		}
		AI_weight = { weight = 1 }
	}
	option = {
		name = cyberization_standards_limited
		policy_flags = { cyberization_standards_limited }
		on_enabled = {
			hidden_effect = {
				if = {
					limit = {
						any_situation = {
							is_situation_type = situation_cyberization
							OR = {
								has_situation_flag = cyberization_ongoing
								has_situation_flag = cyberization_ongoing_forced
							}
						}
					}
					random_situation = {
						limit = {
							is_situation_type = situation_cyberization
							OR = {
								has_situation_flag = cyberization_ongoing
								has_situation_flag = cyberization_ongoing_forced
							}
						}
						remove_situation_flag = cyberization_ongoing
						remove_situation_flag = cyberization_ongoing_forced
						set_situation_flag = cyberization_ongoing_limited
					}
				}
				if = {
					limit = {
						any_situation = {
							is_situation_type = situation_cyberization_hive
							has_situation_flag = cyberization_ongoing
						}
					}
					random_situation = {
						limit = {
							is_situation_type = situation_cyberization_hive
							has_situation_flag = cyberization_ongoing
						}
						remove_situation_flag = cyberization_ongoing
						set_situation_flag = hive_cyberization_ongoing_limited
					}
				}
				every_owned_pop_group = {
					limit = {
						has_ethic = ethic_spiritualist
						has_trait = trait_cybernetic
					}
					species = {
						save_event_target_as = target_species # cyber_species
					}
					convert_to_limited_cybernetic_effect = yes
				}
				every_owned_leader = {
					limit = {
						has_ethic = ethic_spiritualist
						has_trait = leader_trait_cyborg
						is_leader_tier = leader_tier_default
						has_chosen_one_leader_trait = no
					}
					remove_trait = leader_trait_cyborg
					add_trait = { trait = leader_trait_limited_cyborg show_message = no }
					species = {
						save_event_target_as = target_species # cyber_species
					}
					convert_to_limited_cybernetic_effect = yes
				}
				every_pool_leader = {
					limit = {
						has_ethic = ethic_spiritualist
						has_trait = leader_trait_cyborg
					}
					remove_trait = leader_trait_cyborg
					add_trait = { trait = leader_trait_limited_cyborg show_message = no }
					species = {
						save_event_target_as = target_species # cyber_species
					}
					convert_to_limited_cybernetic_effect = yes
				}
			}
		}
		AI_weight = { weight = 1 }
	}
}
